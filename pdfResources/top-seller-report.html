<!DOCTYPE html>
<html lang="en" style="font-size: 10pt; font-family: arial">
    <head>
        <meta name="pdfkit-page-height" content="297mm"/>
        <meta name="pdfkit-page-width" content="210mm"/>
        <meta name="pdfkit-margin-top" content="25mm"/>
        <meta name="pdfkit-margin-bottom" content="8mm"/>
        <meta name="pdfkit-margin-left" content="5mm"/>
        <meta name="pdfkit-margin-right" content="5mm"/>

        <meta name="pdfkit-header-line" content=""/>
        <meta name="pdfkit-header-spacing" content="2"/>
        <meta name="pdfkit-header-html" content="./pdfResources/header_rendered.html"/>

        <meta name="pdfkit-footer-line" content=""/>
        <meta name="pdfkit-footer-font-size" content="8"/>
        <meta name="pdfkit-footer-left" content="Page [page] (This is a system generated document)"/>
    </head>

{# Macros #}
{% macro writeString(str) %}
        {% if str %}
            {{ str }}
        {% else %}
             NA 
        {% endif %}
{% endmacro %}

{# multiple inputs ? #}
{% macro writeParam(str) %}
        {% if str %}
            {{ str }}
        {% else %}
            NOT SELECTED
        {% endif %}
{% endmacro %}

{% macro writeDecimal(str) %}
        {% if str %}
            {{ str|round(2,'floor') }}
        {% else %}
            0
        {% endif %}
{% endmacro %}

{% macro writeInteger(str) %}
        {% if str %}
            {{ str|int }}
        {% else %}
            0
        {% endif %}
{% endmacro %}

    <body>
        <table style="border-collapse: collapse; width: 100%; table-layout: fixed;" border="0">
            <colgroup>
                <col style="width: 25%">
                <col style="width: 25%">
                <col style="width: 25%">
            </colgroup>
            <tbody style="padding: 2pt; line-height: 15pt; font-size : 10pt">
                <tr>
                    <td>Start Date : {{ writeParam(params.start_date) }}</td>
                    <td>End Date : {{ writeParam(params.end_date) }}</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td>Category : {{ writeParam(params.category) }} </td>
                    <td>SubCategory : {{ writeParam(params.subcategory) }}</td>
                    <td>Channel Type : {{ writeParam(params.channel) }}</td>
                    <td>Attribute 1: {{ writeParam(params.attribute1) }}</td>
                </tr>
                <tr>
                    <td>Attribute 2 : {{ writeParam(params.attribute2) }}</td>
                    <td>Season : {{ writeParam(params.season) }}</td>
                    <td>Brand : {{ writeParam(params.brand) }} </td>
                    <td>Gender : {{ writeParam(params.gender) }}</td>
                </tr>
                <tr>
                    <td>Style Tagging : {{ writeParam(params.style_tag) }}</td>
                    <td>Sort By : {{ writeParam(params.sort_by) }}</td>
                    <td>Number of Records : {{ writeString(results|length) }}</td>
                    <td>Minimum Healthy Days Live : {{ writeParam(params.minLiveDays) }}</td>
                </tr>
                <tr>
                    <td>Min STR% : {{ writeParam(params.minStrPercentage) }}%</td>
                    <td>Max STR% : {{ writeParam(params.maxStrPercentage) }}%</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
            </tbody>
        </table>

        <br> 
        <table style="border-collapse: collapse; width: 100%; table-layout: fixed;" border="0">
            <colgroup>
                <col style="width: 33%">
                <col style="width: 33%">
                <col style="width: 33%">
            </colgroup>
            <tbody style="padding: 2pt">
            {% if results|length == 0 %} 
                <tr>
                    <td colspan="3" style="text-align: center; margin-bottom: 1mm; margin-top:1mm; font-weight: bold">
                        No Topseller Styles
                    </td>
            {% else %}
                {% for item in results %}
                    <td style="padding: 2pt; "> 
                        <table style="border-collapse: collapse; width: 100%; table-layout: fixed; page-break-inside: avoid" border="0">
                            <colgroup>
                                <col style="width: 50%">
                                <col style="width: 50%">
                            </colgroup>
                            <tbody style="border: solid 1px black;">
                                <tr>
                                    <td colspan="2" style="text-align: center; color: blue; font-weight: bold;">
                                        {{ writeString(item.style) }}
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <img style="padding-left: 5pt; 
                                                    padding-right: 5pt;" 
                                                    height="auto" 
                                                    width="150mm" 
                                                    src="{{ item.imageUrl }}" /> 
                                                    <!-- src="./pdfResources/increff_image.jpg" />  -->

                                    </td>
                                    <td>
                                        <table style="border-collapse: collapse; width: 100%; table-layout: fixed;" border="0">
                                            <colgroup>
                                                <col style="width: 65%">
                                                <col style="width: 35%">
                                            </colgroup>
                                            <tbody>
                                                <tr>
                                                    <td style="font-weight: bold">ROS/ STORE/ WEEK</td>
                                                    <td> {{ writeDecimal(item.healthyRos) }} </td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold">DOH</td>
                                                    <td> {{ writeDecimal(item.doh) }}</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold">MRP</td>
                                                    <td> {{ writeDecimal(item.mrp) }}</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold">STR</td>
                                                    <td> {{ writeDecimal(item.str) }} %</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold">Qty. Sold</td>
                                                    <td> {{ writeInteger(item.rawSalesQty) }}</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold">Revenue</td>
                                                    <td> {{ writeInteger(item.revenue) }} </td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold">Healthy Days Live</td>
                                                    <td> {{ writeInteger(item.avgHealthyDaysLive) }} </td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold">Days Live</td>
                                                    <td> {{ writeInteger(item.avgRawDaysLive) }} </td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold">Closing Stock</td>
                                                    <td> {{ writeInteger(item.closingStock) }} </td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold">Avg. Discount</td>
                                                    <td> {{ writeDecimal(item.averageDiscountPercentage) }} %</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold">No of Stores</td>
                                                    <td> {{ writeInteger(item.noOfStores) }} </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                    {% if(loop.index%3==0 and not loop.last) %}
                </tr>
                <tr>
                    {% endif %}
                {% endfor %}
            {% endif %}
                </tr>
            </tbody>
        </table>

    </body>
</html>